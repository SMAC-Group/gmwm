---
title: "Demo"
output: pdf_document
---
```{r setup, echo=FALSE}
  library("knitr")
  read_chunk("FirstDemo.R")
```

This document illustrates the features of the GMWM package which have been developed to date. The current version is still preliminary and has not been tested extensively. To start, the GMWM package needs to be installed from the source file attached to this email (i.e. type in R: install.packages(path_to_file, repos = NULL, type="source")). Once this is done, load the package as follows:

```{r library_include}
```

Note that this will automatically install the package ggplot2. We can now start using the GMWM package and we will simulate a latent model composed of a White Noise (WN) and an Autoregressive model of order 1 (or AR(1) which is a reparametrization of a Gauss-Markov process). To do so, we do the following:

```{r gen_process, catch = TRUE}
```

We now compute the Wavelet Variance (WV) of the simulated process and plot it using the following commands:

```{r wv , catch = TRUE}
```

Based on the plot, we could assume that the model is in fact an AR(1) + WN process for which we would like to estimate its parameters. We therefore specify the model we would like to estimate

```{r modelTS, catch = TRUE}
```

and subsequently use it in the GMWM estimating function as follows

```{r GMWM, catch = TRUE}
```

The difference between the true and estimated parameters is given below:

```{r results, catch = TRUE}
```

It is also possible, as a visual measure of "goodness of fit" of the estimated model, to see the difference between the estimated WV and the one implied by the estimated parameters. To do so we simply do the following

```{r GMWMplot, catch = TRUE}
```

Next, we consider a real signal issued from a MEMS IMU. To load the data and display the first rows for each sensor we do

```{r imuData, catch = TRUE}
```

To plot the WV (and confidence intervals) for all gyroscopes and accelerometers, we can use the following function 

```{r imuPlot separate, catch = TRUE}
```

but it is also possible to plot all gyroscopes on the same plot (as is the case for accelerometers)

```{r imuPlot combined, catch = TRUE}
```

Let us consider the Gyro on the axis X and, given the estimated WV from the plot, let us estimate a model which is the sum of three AR(1) processes:

```{r imuModel, catch = TRUE}
```

To see the results of the estimation, we can use the summary function as well as visualize the fit of the implied WV to the estimated WV from Gyro X (as done in the simulation example).

```{r imuModel summary, catch = TRUE}
```